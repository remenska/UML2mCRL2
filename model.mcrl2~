%comment 
% created:Sun May 11 19:02:59 CEST 2014
 
%-------sorts--------- 
sort ClassType = struct 
			RequestPreparationAgent | 
			StageRequestAgent | 
			StageMonitorAgent | 
			StorageManagerHandler | 
			StorageManagementDB | 
			RequestFinalizationAgent | 
			CacheReplicas | 
			Tasks | 
			StageRequests | 
			TaskReplicas ; 
sort Method = struct 
			execute | 
			execute_return | 
			prepareNewReplicas | 
			prepareNewReplicas_return | 
			__getNewReplicas | 
			__getNewReplicas_return | 
			__getExistingFiles | 
			__getExistingFiles_return | 
			__getFileSize | 
			__getFileSize_return | 
			__getFileReplicas | 
			__getFileReplicas_return | 
			__reportProblematicFiles | 
			__reportProblematicFiles_return | 
			initialize | 
			initialize_return | 
			getStorageUsage | 
			getStorageUsage_return | 
			submitStageRequests | 
			submitStageRequests_return | 
			_getMissingReplicas | 
			_getMissingReplicas_return | 
			_getOnlineReplicas | 
			_getOnlineReplicas_return | 
			_getOfflineReplicas | 
			_getOfflineReplicas_return | 
			__usage | 
			__usage_return | 
			__cache | 
			__cache_return | 
			__add | 
			__add_return | 
			_issuePrestageRequests | 
			_issuePrestageRequests_return | 
			__sortBySE | 
			__sortBySE_return | 
			__getStagedReplicas | 
			__getStagedReplicas_return | 
			__getWaitingReplicas | 
			__getWaitingReplicas_return | 
			__getOfflineReplicas | 
			__getOfflineReplicas_return | 
			__addAssociatedReplicas | 
			__addAssociatedReplicas_return | 
			__checkIntegrity | 
			__checkIntegrity_return | 
			__reportProblematicFiles | 
			__reportProblematicFiles_return | 
			monitorStageRequests | 
			monitorStageRequests_return | 
			__monitorStorageElementStageRequests | 
			__monitorStorageElementStageRequests_return | 
			__newAccountingDict | 
			__newAccountingDict_return | 
			__getStageSubmittedReplicas | 
			__getStageSubmittedReplicas_return | 
			__reportProblematicFiles | 
			__reportProblematicFiles_return | 
			__wakeupOldRequests | 
			__wakeupOldRequests_return | 
			aman | 
			aman_return | 
			ajPak | 
			ajPak_return | 

			clearFailedTasks | 
			clearFailedTasks_return | 
			callbackDoneTasks | 
			callbackDoneTasks_return | 
			callbackStagedTasks | 
			callbackStagedTasks_return | 
			__performCallback | 
			__performCallback_return | 
			removeUnlinkedReplicas | 
			removeUnlinkedReplicas_return | 
			clearReleasedTasks | 
			clearReleasedTasks_return | 
			setOldTasksAsFailed | 
			setOldTasksAsFailed_return ; 

sort ClassObject = struct
			rpAgent | 
			smDB ; 





%-------end sorts--------- 

 %-------action definitions------- 
act synch_call_send,synch_call_receive:Nat#ClassType#ClassObject#Method; 
act synch_reply_receive,synch_reply_send:Nat#ClassType#ClassObject#Method; 
 
act synch_call:Nat#ClassType#ClassObject#Method; 
act synch_reply:Nat#ClassType#ClassObject#Method; 
 
act asynch_call_send,asynch_call_receive:Nat#ClassType#ClassObject#Method; 
act asynch_call:Nat#ClassType#ClassObject#Method; 
 
act internal; 
%-------end action definitions------- 

%-------Process definitions--------
proc StorageManagementDB_aman(id:Nat) = 
	sum obj:ClassObject.synch_call_receive(id,StorageManagementDB,obj,aman). 
	synch_reply_send(id,StorageManagementDB,obj,aman_return)
;

proc StorageManagementDB_ajPak(id:Nat) = 
	sum obj:ClassObject.synch_call_receive(id,StorageManagementDB,obj,ajPak). 
	synch_reply_send(id,StorageManagementDB,obj,ajPak_return)
;

proc Interaction1(id:Nat) = 
	synch_call_send(id,StorageManagementDB,smDB,aman). 
	synch_reply_receive(id,StorageManagementDB,smDB,aman_return). 
	synch_call_send(id,StorageManagementDB,smDB,ajPak). 
	synch_reply_receive(id,StorageManagementDB,smDB,ajPak_return)
;

%-------End process definitions-------- 
 
%-------systemInitProcess-------- 
 
proc systemInit = Interaction1(1) || 
StorageManagementDB_aman(1) || % Interaction1
StorageManagementDB_ajPak(1) ; 
%-------Init section-------- 

init hide ({internal}, 
allow({internal,synch_call,synch_reply, asynch_call 
}, 
comm({ 
synch_call_send|synch_call_receive->synch_call, 
synch_reply_receive|synch_reply_send->  
synch_reply,  
asynch_call_send|asynch_call_receive->  
asynch_call  
},  
				 systemInit  
)));